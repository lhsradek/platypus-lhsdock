###################### Metricbeat Configuration #######################

http.enabled: true
http.port: 5067
http.hosts:
 - "0.0.0.0"
 - "unix:///var/run/docker.sock"

xpack.monitoring.enabled: true
monitoring.enabled: true
monitoring.cluster_uuid: "N25AxvDIRK-Y_9nKG8BVnA"
cluster.name: "${CLUSTER_NAME}"
cluster.uuid: "N25AxvDIRK-Y_9nKG8BVnA"

metricbeat.config.modules:
  path: ${path.config}/modules.d/*.yml
  reload.enabled: false

processors:
  - add_host_metadata: ~
  - add_cloud_metadata: ~
  - add_docker_metadata: ~
  - add_kubernetes_metadata: ~

output:
  elasticsearch:
    hosts: 
      - "https://es01:9200"
      # - "https://es02:9201"
      # - "https://es03:9202"
    # api_key: ${AGENT_API_KEY}
    username: "${ELASTICSEARCH_USERNAME}"
    password: "${ELASTICSEARCH_PASSWORD}"
    ssl:
      enabled: true
      certificate_authorities: ["${ELASTICSEARCH_SSL_CERTIFICATEAUTHORITIES}"]

setup:
  template.settings:
    index.number_of_shards: 1
    index.codec: best_compression
    source.enabled: false
  elasticsearch:
    hosts: 
      - "https://es01:9200"
      - "https://es02:9201"
      - "https://es03:9202"
    # api_key: ${AGENT_API_KEY}
    username: "${ELASTICSEARCH_USERNAME}"
    password: "${ELASTICSEARCH_PASSWORD}"
    ssl:
      enabled: true
      certificate_authorities: ["${ELASTICSEARCH_SSL_CERTIFICATEAUTHORITIES}"]
  kibana:
    host: 'https://kibana:5601'
    # api_key: ${AGENT_API_KEY}
    username: "${ELASTICSEARCH_USERNAME}"
    password: "${ELASTICSEARCH_PASSWORD}"
    ssl:
      enabled: true
      certificate_authorities: ["${ELASTICSEARCH_SSL_CERTIFICATEAUTHORITIES}"]
  apm:
    enabled: true
    service_name: "metricbeat"
    server_url: "http://apm:8200"
